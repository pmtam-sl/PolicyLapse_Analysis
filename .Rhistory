options(datadist="d")
lrm1 = lrm(Lapse  ~NumOfReinstated,dat2)
lrm2 = lrm(Lapse ~NumOfReinstated+NumOfEmails+NumOfCalls ,dat2)
lrmful = lrm(Lapse ~. , dat2 )
lrtest(lrm1,lrm2)
summary (lrm1);summary(lrm2);summary(lrmful)
AIC(lrm1);AIC(lrm2);AIC(lrmful)
lrmful
summary(lrmful)
lrmful
temp
knitr::opts_chunk$set(echo = TRUE)
lrm3 = lrm(Lapse ~ Premium, dat1)
knitr::opts_chunk$set(echo = TRUE)
Occ <- read.csv("/Users/tamphamminh/OneDrive/Learning/R for Data Science/Insurance_practices/data/Lap_Occupation.csv",header =T)
Occ2 <- read.csv("/Users/tamphamminh/OneDrive/Learning/R for Data Science/Insurance_practices/data/Lap_Occupation2.csv",header =T)
Occ$Premium <-gsub (",","",Occ$Premium) %>%
as.numeric()
library(rms)
library(rms)
library(tidyverse)
Occ$Premium <-gsub (",","",Occ$Premium) %>%
as.numeric()
Occ2$Premium <-gsub (",","",Occ2$Premium) %>%
as.numeric()
Occ.glm2 = glm(Lapse~ PO_Occupation, family = binomial, data=Occ)
Occ.glm3 = glm(Lapse~ PremiumG , family = binomial, data=Occ)
Occ.glm4 = glm(Lapse~ Premium , family = binomial, data=Occ)
Occ.glm23 = glm(Lapse~ PO_Occupation+PremiumG , family = binomial, data=Occ)
Occ.glm24 = glm(Lapse~ PO_Occupation+Premium, family = binomial, data=Occ)
Occ2.glm2 = glm(Lapse~ PO_Occupation, family = binomial, data=Occ2)
Occ2.glm3 = glm(Lapse~ PremiumG , family = binomial, data=Occ2)
Occ2.glm3 = glm(Lapse~ PremiumG , family = binomial, data=Occ2)
Occ2.glm4 = glm(Lapse~ Premium , family = binomial, data=Occ2)
Occ2.glm23 = glm(Lapse~ PO_Occupation+PremiumG , family = binomial, data=Occ2)
Occ2.glm24 = glm(Lapse~ PO_Occupation+Premium, family = binomial, data=Occ2)
summary(Occ.glm2);summary(Occ2.glm2)
d1=datadist(Occ)
options(datadist="d1")
Occ.lrm2 = lrm(Lapse ~ PO_Occupation, Occ)
Occ.lrm3 = lrm(Lapse ~ PremiumG, Occ)
Occ.lrm23 = lrm(Lapse ~ PO_Occupation+PremiumG, Occ)
Occ2.lrm2 = lrm(Lapse ~ PO_Occupation, Occ2)
Occ2.lrm23 = lrm(Lapse ~ PO_Occupation+PremiumG, Occ2)
summary(Occ.lrm2);summary(Occ2.lrm2)
exp(-0.67475)
summary(Occ.lrm3);summary(Occ2.lrm3)
Occ2.lrm3 = lrm(Lapse ~ PremiumG, Occ2)
summary(Occ.lrm3);summary(Occ2.lrm3)
summary(Occ.glm3);summary(Occ2.glm3)
summary(Occ.glm2);summary(Occ2.glm2)
exp(-0.57)
summary(Occ.lrm2);summary(Occ2.lrm2)
exp(-0.71876)
summary(Occ.lrm3);summary(Occ2.lrm3)
Occ.lrm4 = lrm(Lapse ~ Premium, Occ)
Occ2.lrm4 = lrm(Lapse ~ Premium, Occ2))
Occ2.lrm4 = lrm(Lapse ~ Premium, Occ2)
summary(Occ.lrm4);summary(Occ2.lrm4)
summary(Occ.lrm2);summary(Occ2.lrm2)
summary(Occ.lrm4);summary(Occ2.lrm4)
summary(Occ.lrm2);summary(Occ2.lrm2)
summary(Occ.glm2);summary(Occ2.glm2)
summary(Occ.lrm2);summary(Occ2.lrm2)
Occ
describeBy
describy
summary(Occ)
Occ3 <- Occ
Occ3$Lapse <- as.factor
Occ3$Lapse <- as.factor(Occ3$Lapse)
Occ3
summary(Occ3)
Occ3 <- Occ2
Occ3$Lapse <- as.factor(Occ3$Lapse)
Occ3$Occupation <- as.factor(Occ3$PO_Occupation)
Occ3$PremiumG <- as.factor(Occ3$PremiumG)
summary(Occ3)
Occ3.lrm2 = lrm(Lapse ~ PO_Occupation, Occ3)
Occ3.lrm21 = lrm(Lapse ~ Occupation, Occ3)
Occ3.lrm3 = lrm(Lapse ~ PremiumG, Occ3)
Occ3.lrm4 = lrm(Lapse ~ Premium, Occ3)
Occ3.lrm23 = lrm(Lapse ~ PO_Occupation+PremiumG, Occ3)
summary(Occ.lrm2);summary(Occ2.lrm2);summary(Occ3.lrm2);summary(Occ3.lrm21)
Occ3.lrm21 = lrm(Lapse ~ Occupation, Occ3)
View(Occ3.lrm21)
Occ3.lrm21
Occ3.lrm2
Occ2.lrm2
summary(Occ3.lrm21)
d3=datadist(Occ3)
options(datadist="d3")
summary(Occ3.lrm21)
# Read data
dat <- read.csv("/Users/tamphamminh/OneDrive/Learning/R for Data Science/Insurance_practices/data/Insurance.csv",header =T)
#Col1=c("Lapse","PO_Sex","PO_Occupation","Premium","PremiumG","CoveragePeriod","PaymentTerm")
Col1=c("Lapse","PO_Sex","Occupation","PremiumG","CoveragePeriod","PaymentTerm")
dat1 <- dat[,Col1]
glm1 = glm(Lapse~ PO_Sex, family = binomial, data=dat1)
glm2 = glm(Lapse~ PO_Occupation, family = binomial, data=dat1)
glm2 = glm(Lapse~ Occupation, family = binomial, data=dat1)
glm3 = glm(Lapse~ PremiumG , family = binomial, data=dat1)
glm23 = glm(Lapse~ Occupation+PremiumG , family = binomial, data=dat1)
glm123 = glm(Lapse~ PO_Sex+Occupation+PremiumG, family = binomial, data=dat1)
summary(glm1);summary(glm2);summary(glm3);summary(glm23);summary(glm123)
AIC(glm2);AIC(glm3);AIC(glm23);AIC(glm123)
# Thu tim mo6 hinh toi uu
temp = glm(Lapse ~ ., family = binomial , data = dat1)
search = step(temp)
search
# Chay với BMA
library(BMA)
outcome =dat1[,1] # Gán biến outcome
bma.search = bic.glm(predictors,outcome, strict=F, OR=20, glm.family="binomial")
View(dat1)
predictors = dat1[,2:6] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
outcome =dat1[,1] # Gán biến outcome
bma.search = bic.glm(predictors,outcome, strict=F, OR=20, glm.family="binomial")
summary(bma.search)
lrm2 = lrm(Lapse ~ Occupation, dat1)
# Chạy với lrm
d=datadist(dat1)
options(datadist="d")
lrm1 = lrm(Lapse ~ PO_Sex, dat1)
lrm2 = lrm(Lapse ~ Occupation, dat1)
lrm3 = lrm(Lapse ~ PremiumG, dat1)
# Kiểm tra Khác biệt giữa mô hình tương tác
lrm23 = lrm(Lapse ~ Occupation*PremiumG, dat1)
lrm2.3 = lrm(Lapse ~ Occupation+PremiumG, dat1)
lrm23 # Xem xét p của PO_Occupation * Premium tat thấy p < 0.05 ==> có ý nghĩa tương tác
lrm2.3
lrmful = lrm(Lapse ~ ., dat1)
lsummary (lrm1);summary(lrm2); summary(lrm12);summary(lrm3);summary(lrm23)
summary (lrm1);summary(lrm2); summary(lrm12);summary(lrm3);summary(lrm23)
summary (lrm1);summary(lrm2);summary(lrm3);summary(lrm23)
AIC(lrm1);AIC(lrm2);AIC(lrm3);AIC(lrm23);AIC(lrm123)
AIC(lrm1);AIC(lrm2);AIC(lrm3);AIC(lrm23)
AIC(lrmful)
summary(bma.search)
knitr::opts_chunk$set(echo = TRUE)
library(rms)
library(rms)
library(tidyverse)
Occ <- read.csv("/Users/tamphamminh/OneDrive/Learning/R for Data Science/Insurance_practices/data/Lap_Cover.csv",header =T)
Occ2 <- read.csv("/Users/tamphamminh/OneDrive/Learning/R for Data Science/Insurance_practices/data/Lap_Occupation2.csv",header =T)
Occ$Premium <-gsub (",","",Occ$Premium) %>%
as.numeric()
Occ2$Premium <-gsub (",","",Occ2$Premium) %>%
as.numeric()
Occ.glm2 = glm(Lapse~ PO_Occupation, family = binomial, data=Occ)
Occ.glm2 = glm(Lapse~ Occupation, family = binomial, data=Occ)
Occ.glm3 = glm(Lapse~ PremiumG , family = binomial, data=Occ)
Occ.glm4 = glm(Lapse~ Premium , family = binomial, data=Occ)
Occ.glm5 = glm(Lapse~ CoveragePeriod , family = binomial, data=Occ)
Occ.glm5 = glm(Lapse~ CoveragePeriod , family = binomial, data=Occ)
Occ.glm6 = glm(Lapse~ PaymentTerm , family = binomial, data=Occ)
Occ2.glm2 = glm(Lapse~ PO_Occupation, family = binomial, data=Occ2)
Occ2.glm3 = glm(Lapse~ PremiumG , family = binomial, data=Occ2)
Occ2.glm4 = glm(Lapse~ Premium , family = binomial, data=Occ2)
Occ.glm23 = glm(Lapse~ Occupation+PremiumG , family = binomial, data=Occ)
Occ.glm24 = glm(Lapse~ Occupation+Premium, family = binomial, data=Occ)
Occ2.glm23 = glm(Lapse~ PO_Occupation+PremiumG , family = binomial, data=Occ2)
Occ2.glm24 = glm(Lapse~ PO_Occupation+Premium, family = binomial, data=Occ2)
summary(Occ.glm2);summary(Occ2.glm2)
summary(Occ.glm5);summary(Occ.glm6)
Occ.lrm23 = lrm(Lapse ~ Occupation+PremiumG+CoverragePeriod+PaymentTerm, Occ)
Occ.lrm2 = lrm(Lapse ~ Occupation, Occ)
Occ.lrm3 = lrm(Lapse ~ PremiumG, Occ)
Occ.lrm4 = lrm(Lapse ~ Premium, Occ)
Occ.lrm23 = lrm(Lapse ~ Occupation+PremiumG+CoveragePeriod+PaymentTerm, Occ)
Occ.lrm23
Occ
temp = glm(Lapse ~ ., family = binomial , data = Occ)
search = step(temp)
search
Occ
View(Occ)
Occ3 <- Occ[,c(1,3:7)]
Occ3
View(Occ3)
temp = glm(Lapse ~ ., family = binomial , data = Occ3)
search = step(temp)
search
summary(search)
View(Occ2)
Occ3
summary(search)
search
temp2 = glm(Lapse ~ ., family = binomial , data = Occ2)
search2 = step(temp2)
search2
search
predictors1 = Occ3[,2:6] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
outcome1 =Occ3[,1] # Gán biến outcome
bma.search1 = bic.glm(predictors1,outcome1, strict=F, OR=20, glm.family="binomial")
# Run BMA
library(BMA)
bma.search1 = bic.glm(predictors1,outcome1, strict=F, OR=20, glm.family="binomial")
summary(bma.search1)
predictors2 = Occ2[,2:4] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
outcome2 =Occ2[,1] # Gán biến outcome
bma.search2 = bic.glm(predictors2,outcome2, strict=F, OR=20, glm.family="binomial")
summary(bma.search2)
search
search2
Occ3.lrm2 = lrm(Lapse ~ Occupation, Occ3)
Occ3.lrm3 = lrm(Lapse ~ PremiumG, Occ3)
Occ3.lrm4 = lrm(Lapse ~ Premium, Occ3)
Occ3.lrm5 = lrm(Lapse ~ CoveragePeriod, Occ3)
Occ3.lrm6 = lrm(Lapse ~ PaymentTerm, Occ3)
Occ3.lrm23 = lrm(Lapse ~ Occupation+PremiumG, Occ3)
summary(Occ.lrm2);summary(Occ2.lrm2);summary(Occ3.lrm2);summary(Occ3.lrm21)
Occ.lrm2 = lrm(Lapse ~ Occupation, Occ)
Occ.lrm3 = lrm(Lapse ~ PremiumG, Occ)
Occ.lrm4 = lrm(Lapse ~ Premium, Occ)
Occ.lrm23 = lrm(Lapse ~ Occupation+PremiumG+CoveragePeriod+PaymentTerm, Occ)
Occ2.lrm2 = lrm(Lapse ~ PO_Occupation, Occ2)
Occ2.lrm3 = lrm(Lapse ~ PremiumG, Occ2)
Occ2.lrm4 = lrm(Lapse ~ Premium, Occ2)
Occ2.lrm23 = lrm(Lapse ~ PO_Occupation+PremiumG, Occ2)
summary(Occ.lrm2);summary(Occ2.lrm2);summary(Occ3.lrm2);summary(Occ3.lrm21)
summary(Occ.lrm3);summary(Occ2.lrm3)
# Read data
dat <- read.csv("/Users/tamphamminh/OneDrive/Learning/R for Data Science/Insurance_practices/data/Insurance.csv",header =T)
#Col1=c("Lapse","PO_Sex","PO_Occupation","Premium","PremiumG","CoveragePeriod","PaymentTerm")
Col1=c("Lapse","PO_Sex","Occupation","PremiumG","CoveragePeriod","PaymentTerm")
dat1 <- dat[,Col1]
View(dat1)
glm1 = glm(Lapse~ PO_Sex, family = binomial, data=dat1)
glm2 = glm(Lapse~ Occupation, family = binomial, data=dat1)
glm3 = glm(Lapse~ PremiumG , family = binomial, data=dat1)
glm4 = glm(Lapse~ CoveragePeriod, family = binomial, data=dat1)
glm5 = glm(Lapse~ PaymentTerm, family = binomial, data=dat1)
glm23 = glm(Lapse~ Occupation+PremiumG , family = binomial, data=dat1)
glm123 = glm(Lapse~ PO_Sex+Occupation+PremiumG, family = binomial, data=dat1)
summary(glm1);summary(glm2);summary(glm3);summary(glm4);summary(glm5)
summary(glm23);summary(glm123)
AIC(glm2);AIC(glm3);AIC(glm4);AIC(glm5)
AIC(glm23);AIC(glm123)
glm34 = glm(Lapse~ PremiumG+CoveragePeriod, family = binomial, data=dat1)
glm35 = glm(Lapse~ PremiumG+PaymentTerm, family = binomial, data=dat1)
glm345 = glm(Lapse~ PremiumG+CoveragePeriod+PaymentTerm , family = binomial, data=dat1)
summary(glm1);summary(glm2);summary(glm3);summary(glm4);summary(glm5)
summary(glm23);summary(glm123);summary(glm34);summary(glm35);summary(glm345)
AIC(glm2);AIC(glm3);AIC(glm4);AIC(glm5)
AIC(glm23);AIC(glm123);AIC(glm34);AIC(glm35);AIC(glm345)
# Thu tim mo6 hinh toi uu
temp = glm(Lapse ~ ., family = binomial , data = dat1)
search = step(temp)
search
AIC(glm1)
glm1
glm34
summary(glm34)
View(dat)
# Do Premium là Charater nên đa phải đổi
dat1$PremiumG <-gsub (",","",dat$Premium) %>%
as.numeric()
glm3 = glm(Lapse~ PremiumG , family = binomial, data=dat1)
glm23 = glm(Lapse~ Occupation+PremiumG , family = binomial, data=dat1)
glm123 = glm(Lapse~ PO_Sex+Occupation+PremiumG, family = binomial, data=dat1)
glm34 = glm(Lapse~ PremiumG+CoveragePeriod, family = binomial, data=dat1)
glm35 = glm(Lapse~ PremiumG+PaymentTerm, family = binomial, data=dat1)
glm345 = glm(Lapse~ PremiumG+CoveragePeriod+PaymentTerm , family = binomial, data=dat1)
summary(glm1);summary(glm2);summary(glm3);summary(glm4);summary(glm5)
summary(glm23);summary(glm123);summary(glm34);summary(glm35);summary(glm345)
AIC(glm2);AIC(glm3);AIC(glm4);AIC(glm5)
AIC(glm23);AIC(glm123);AIC(glm34);AIC(glm35);AIC(glm345)
# Thu tim mo6 hinh toi uu
temp = glm(Lapse ~ ., family = binomial , data = dat1)
search = step(temp)
search
summary(dat1)
dat1$Lapse <- as.factor()
dat1$Lapse <- as.factor(dat1$Lapse)
summary(dat1)
dat1$Occupation <-as.factor(Occupation)
dat1$Occupation <-as.factor(dat$Occupation)
summary(dat1)
View(dat1)
glm1 = glm(Lapse~ PO_Sex, family = binomial, data=dat1)
glm2 = glm(Lapse~ Occupation, family = binomial, data=dat1)
glm3 = glm(Lapse~ PremiumG , family = binomial, data=dat1)
glm4 = glm(Lapse~ CoveragePeriod, family = binomial, data=dat1)
glm5 = glm(Lapse~ PaymentTerm, family = binomial, data=dat1)
glm123 = glm(Lapse~ PO_Sex+Occupation+PremiumG, family = binomial, data=dat1)
glm34 = glm(Lapse~ PremiumG+CoveragePeriod, family = binomial, data=dat1)
glm35 = glm(Lapse~ PremiumG+PaymentTerm, family = binomial, data=dat1)
glm345 = glm(Lapse~ PremiumG+CoveragePeriod+PaymentTerm , family = binomial, data=dat1)
summary(glm1);summary(glm2);summary(glm3);summary(glm4);summary(glm5)
summary(glm23);summary(glm123);summary(glm34);summary(glm35);summary(glm345)
AIC(glm2);AIC(glm3);AIC(glm4);AIC(glm5)
AIC(glm23);AIC(glm123);AIC(glm34);AIC(glm35);AIC(glm345)
# Thu tim mo6 hinh toi uu
temp = glm(Lapse ~ ., family = binomial , data = dat1)
search = step(temp)
search
glm34
summary(glm34)
search
# Chạy với lrm
d=datadist(dat1)
options(datadist="d")
# Chạy với lrm
d=datadist(dat1)
options(datadist="d")
lrm1 = lrm(Lapse ~ PO_Sex, dat1)
lrm2 = lrm(Lapse ~ Occupation, dat1)
lrm3 = lrm(Lapse ~ PremiumG, dat1)
lrm4 = lrm(Lapse ~ CoveragePeriod , dat1)
lrm5 = lrm(Lapse ~ PaymentTerm , dat1)
# Kiểm tra Khác biệt giữa mô hình tương tác
lrm23 = lrm(Lapse ~ Occupation*PremiumG, dat1)
lrm2.3 = lrm(Lapse ~ Occupation+PremiumG, dat1)
lrm23 # Xem xét p của PO_Occupation * Premium tat thấy p < 0.05 ==> có ý nghĩa tương tác
# Chay với BMA
library(BMA)
predictors = dat1[,2:6] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
outcome =dat1[,1] # Gán biến outcome
bma.search = bic.glm(predictors,outcome, strict=F, OR=20, glm.family="binomial")
summary(bma.search)
dat2 <- dat[,Col1]
View(dat2)
dat2$Lapse <- as.factor(dat2$Lapse)
dat2$Occupation <- as.factor(dat2$Occupation)
predictors = dat2[,2:6] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
outcome =dat2[,1] # Gán biến outcome
bma.search = bic.glm(predictors,outcome, strict=F, OR=20, glm.family="binomial")
summary(bma.search)
dat2 <- dat[,Col1]
View(dat2)
predictors = dat2[,2:6] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
outcome =dat2[,1] # Gán biến outcome
bma.search = bic.glm(predictors,outcome, strict=F, OR=20, glm.family="binomial")
summary(bma.search)
dat2$Occupation <- as.factor(dat2$Occupation)
summary(bma.search)
predictors = dat2[,2:6] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
summary(bma.search)
bma.search = bic.glm(predictors,outcome, strict=F, OR=20, glm.family="binomial")
summary(bma.search)
View(dat2)
imageplot.bma(bma.search)
library(rms)
library(tidyverse)
# Read data
dat <- read.csv("/Users/tamphamminh/OneDrive/Learning/R for Data Science/Insurance_practices/data/Insurance.csv",header =T)
#Col1=c("Lapse","PO_Sex","PO_Occupation","Premium","PremiumG","CoveragePeriod","PaymentTerm")
Col1=c("Lapse","PO_Sex","Occupation","Premium","CoveragePeriod","PaymentTerm")
dat1 <- dat[,Col1]
# Do Premium là Character nên đa phải đổi
dat1$Premium <-gsub (",","",dat$Premium) %>%
as.numeric()
# Thu tim mo6 hinh toi uu
temp = glm(Lapse ~ ., family = binomial , data = dat1)
search = step(temp)
search
summary(search)
summary(temp)
search
summary(search)
View(search)
search$coefficients[1]
# Chay với BMA
library(BMA)
View(dat1)
predictors = dat1[,2:6] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
outcome =dat1[,1] # Gán biến outcome
bma.search = bic.glm(predictors,outcome, strict=F, OR=20, glm.family="binomial")
summary(bma.search)
lrm1 = lrm(Lapse ~ Premium+CoveragePeriod, dat1)
# Chạy với lrm
d=datadist(dat1)
options(datadist="d")
lrm1 = lrm(Lapse ~ Premium+CoveragePeriod, dat1)
lrm2 = lrm(Lapse ~ Occupation+Premium+CoveragePeriod, dat1)
summary(lrm1)
lrm1
summary(lrm2)
search
glm1 = glm(Lapse~ Premium+CoveragePeriod , family = binomial, data=dat1)
glm2 = glm(Lapse~ Occupation+Premium+CoveragePeriod , family = binomial, data=dat1)
glm1
summary(glm1)
lrm1
glm1
lrm2
glm2
glm2
dat2 <- dat1
dat2
View(dat2)
dat2$Occupation <-as.factor(dat2$Occupation)
dat2$CoveragePeriod <-as.factor(dat2$CoveragePeriod)
dat2.glm2 = glm(Lapse ~ Occupation+Premium+CoveragePeriod, data=dat2, family="binomial")
dat2.glm2
summary(dat2.glm2)
# Các mô hình
Col2 = c("Lapse","NumOfReinstated","NumOfClaims","NumOfEmails","NumOfCalls")
dat2 <- dat[,Col2]
# Read data
dat <- read.csv("/Users/tamphamminh/OneDrive/Learning/R for Data Science/Insurance_practices/data/Insurance.csv",header =T)
dat2 <- dat[,Col2]
glm1 = glm(Lapse  ~ NumOfReinstated, family = binomial, data=dat2 )
glm2 = glm(Lapse ~ NumOfClaims, family = binomial, data = dat2)
glm3 = glm(Lapse  ~NumOfReinstated+NumOfEmails+NumOfCalls, family=binomial, data=dat2)
summary (glm1);summary(glm2);summary(glm3)
AIC(glm1);AIC(glm2);AIC(glm3)
temp = glm(Lapse ~ ., family = binomial , data = dat2)
search
search = step(temp)
search
search
summary(search)
AIC(glm1);AIC(glm2);AIC(glm3)
glm3
search
exp(0.2582)
summary(search)
temp2 = glm(Lapse ~ ., family = binomial , data = dat2)
search2 = step(temp2)
search2
summary(search2)
# Bayesian Model Average (BMA)
library(BMA)
predictors = dat2[,2:5] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
outcome =dat2[,1] # Gán biến outcome
bma2.search = bic.glm(predictors,outcome, strict=F, OR=20, glm.family="binomial")
summary(bma2.search)
d=datadist(dat2)
options(datadist="d")
lrm1 = lrm(Lapse  ~NumOfReinstated,dat2)
lrm2 = lrm(Lapse ~NumOfReinstated*NumOfEmails*NumOfCalls ,dat2)
lrmful = lrm(Lapse ~. , dat2 )
lrtest(lrm1,lrm2)
summary (lrm1);summary(lrm2);summary(lrmful)
AIC(lrm1);AIC(lrm2);AIC(lrmful)
lrm2 = lrm(Lapse ~NumOfReinstated+NumOfEmails+NumOfCalls ,dat2)
lrmful = lrm(Lapse ~. , dat2 )
lrtest(lrm1,lrm2)
summary (lrm1);summary(lrm2);summary(lrmful)
AIC(lrm1);AIC(lrm2);AIC(lrmful)
View(bma2.search)
bma.search2
bma2.search
summary(bma2.search)
library(rms)
library(tidyverse)
library(BMA)
# Read data
dat <- read.csv("/Users/tamphamminh/OneDrive/Learning/R for Data Science/Insurance_practices/data/Insurance.csv",header =T)
Col1=c("Lapse","PO_Sex","Occupation","Premium","CoveragePeriod","PaymentTerm")
dat1 <- dat[,Col1]
# Do Premium là Character nên đa phải đổi
dat1$Premium <-gsub (",","",dat$Premium) %>%
as.numeric()
#Thu tim mo hinh toi uu
temp = glm(Lapse ~ ., family = binomial , data = dat1)
search = step(temp)
search = step(temp)
search
glm1 = glm(Lapse~ Premium+CoveragePeriod , family = binomial, data=dat1)
glm2 = glm(Lapse~ Occupation+Premium+CoveragePeriod , family = binomial, data=dat1)
glm2
summary(glm2)
# Chạy với lrm
d=datadist(dat1)
options(datadist="d")
# Chay với BMA
# library(BMA)
predictors = dat1[,2:6] # lấy lại ma trận txt từ cột 2 đến 5 - loại trừ Lapse
outcome =dat1[,1] # Gán biến outcome
bma.search = bic.glm(predictors,outcome, strict=F, OR=20, glm.family="binomial")
summary(bma.search)
lrm1 = lrm(Lapse ~ Premium+CoveragePeriod, dat1)
lrm2 = lrm(Lapse ~ Occupation+Premium+CoveragePeriod, dat1)
lrm2
summary(lrm2)
search
summary(search)
lrm2
summary(search)
summary(lrm2)
exp(-0.18687)
View(search)
summary(dat1)
sd(dat1$premium)
sd(dat1$Premium)
lrm2
summary(lrm2)
?lrm
16420-4738.3
summary(dat1)
knitr::opts_chunk$set(echo = TRUE)
library(rms)
library(rms)
library(tidyverse)
library(BMA)
Col1=c("Lapse","PO_Sex","Occupation","Premium","CoveragePeriod","PaymentTerm")
dat1 <- dat[,Col1]
# Do Premium là Character nên đa phải đổi
dat1$Premium <-gsub (",","",dat$Premium) %>%
as.numeric()
glm2 = glm(Lapse~ Occupation, family = binomial, data=dat1)
glm2
summary(glm2)
exp(0.1261)
search$coefficients[1]
round(search$coefficients[1],4)
knitr::opts_chunk$set(echo = TRUE)
round(search$coefficients[3],4)
round(search$coefficients[3],5)
